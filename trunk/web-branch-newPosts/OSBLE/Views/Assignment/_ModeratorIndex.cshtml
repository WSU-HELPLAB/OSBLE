@using OSBLE.Models
@using OSBLE.Models.Assignments


<table class="assignTable" cellspacing="0">
    <tr>
        <th style="font-size:larger; padding-right:20px">Assignment</th>
        <th style="font-size:larger">Due Date</th>
    </tr>

    @{
        //MG & KD: Assignments are in order based on:: past & present -> future -> draft. The flags below are used to avoid duplicate headers for each category
        bool futureFlag = false, presentFlag = false, pastFlag = false;
        foreach (Assignment assignment in ViewBag.Assignments)
        {
            //Order of if checks is important as these if/else ifs are using short-circuiting.
            if (assignment.DueDate < ViewBag.CurrentDate && !pastFlag)
            {
                //PAST
                pastFlag = true;
                <tr><td colspan="100%" style="padding-right:0; font-size:large" class="osbleColorBold">Past (@ViewBag.PastCount)</td></tr>
            }
            else if (assignment.ReleaseDate > ViewBag.CurrentDate && !futureFlag)
            {
                //FUTURE
                futureFlag = true;
                if (pastFlag || presentFlag)
                {
                    <tr><td style="padding-bottom:10px"></td></tr>
                }
                <tr><td colspan="100%" style="padding-right:0; font-size:large" class="osbleColorBold">Future (@ViewBag.FutureCount)</td></tr>
                
            }
            else if (assignment.DueDate >= ViewBag.CurrentDate && !presentFlag)
            {
                //PRESENT
                presentFlag = true;
                if (pastFlag)
                {
                    <tr><td style="padding-bottom:10px"></td></tr>
                }
                <tr><td colspan="100%" style="padding-right:0; font-size:large" class="osbleColorBold">Present (@ViewBag.PresentCount)</td></tr>
            }

            //Now that headers are in place, inserting a assignment
            <tr class="checkeredRow"  >
                <td > <!--Cell for name-->
                    @Html.ActionLink(assignment.AssignmentName, "Index", "Home", new { area = "AssignmentDetails", assignmentId = assignment.ID }, null)
                </td>
                <td>@assignment.DueDate.ToShortDateString() @assignment.DueTime.ToShortTimeString()</td>
            </tr>
                
        }
    }
</table>
